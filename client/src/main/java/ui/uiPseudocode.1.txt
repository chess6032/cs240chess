SUPERCLASS:

C = ???

abstract help() => void
abstract badInput() => void

final Map<C, func> commandToEval // defined in subclasses

rep() {
    // READ

    scan System.in -> String line
    parse(line) -> C command, String[] args

    // EVAL

    try:
        eval(command, args)
    catch InvalidArgumentException:
        badInput()
}

parse(String line) => C, String[] {
    split line -> String[] args
    parseCommand(args[0]) -> C command
    return command, args[1:]
}

eval(C command, String[] args) => void? {
    // ummmmm OK I think doing a Switch is easier actually
}



setClientState(State state) => void {
    ???
}

setClientAuth(AuthData auth) => void {
    ???
}


PRELOGIN:

commandToEval = {
    HELP: help()
    REGISTER: register(String[])
    LOGIN: login(String[])
    EXIT: setClientState(QUIT)
}

register(String[] args) => void? {
    setClientAuth( ServerFacade.register(new UserData(args[0], args[1], args[2])) )
    setClientState(POSTLOGIN)
}

login(args) => void? {
    setClientAuth( ServerFacade.login(new UserData(args[0], args[1], null)) )
    setClientState(POSTLOGIN)
}

POSTLOGIN:

commandToEval = {
    HELP: help()
    CREATE GAME: createGame(String[])
    PLAY GAME: playGame(String[])
    LIST GAMES: listGames(String[])
    LOGOUT: setClientState(PRELOGIN)
}

createGame(String[] args) => void? {
    ServerFacade.createGame(clientAuth, gameName: args[0])
    setClientState(GAMEPLAY)
}

playGame(String[] args) => void? {
    ServerFacade.joinGame(clientAuth, new PlayerColorGameIDforJSON(playerColor: args[1], gameID: args[0])
    setClientState(GAMEPLAY)
}

listGames(String[] args) => void? {
    ServerFacade.listGames(clientAuth)
    setClientState(GAMEPLAY)
}
